install.packages("C:/Users/eschumacher/Downloads/Demerelate_0.8-0.tar.gz", repos = NULL, type = "source")
install.packages("C:/Users/eschumacher/Downloads/R-3.4.4-win.exe", repos = NULL)
install.packages("C:/Users/eschumacher/Downloads/Demerelate_0.8-0.tar.gz", repos = NULL, type = "source")
library(tidyverse)
library(ggplot2)
#set working directory
setwd("../../..")
#read in summary df for final figures
UHA_res_df <- read.csv("Results/Parentage_Results/CSV_Files/UHA_HCF_all_loci_analysis_df.csv")
#load in list of parentage summary results CSVs
par_sum_df <- list.files(path = "Results/Parentage_Results/CSV_Files",
pattern = "par_sum.csv")
#reorg list to fit order
par_sum_df <- list(par_sum_df[[2]], par_sum_df[[1]],
par_sum_df[[4]], par_sum_df[[3]])
#load full scenario data frames
full_scen <- c("all_loci_AF", #all loci included with all father assignments
"all_loci_HCF", #all loci with only high confidence fathers included
"red_loci_AF", #reduced loci with all father assignments
"red_loci_HCF" #reduce loci with only high confidence father assignments included
)
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
#rename
colnames(UHA_father_df) <- c("Species", "Count")
UHA_father_df %>%
ggplot(aes(x = fct_infreq(Species), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
class(UHA_father_df$Species)
UHA_father_df %>%
UHA_father_df %>%
ggplot(aes(x = fct_rev(fct_infreq(Maternal_ID)), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
#rename
colnames(UHA_father_df) <- c("Species", "Count")
UHA_father_df %>%
ggplot(aes(x = fct_rev(fct_infreq(Maternal_ID)), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
UHA_father_df %>%
ggplot(aes(x = fct_rev(fct_infreq(Species)), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
UHA_father_df %>%
ggplot(aes(x = fct_rev(Species), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
?fct_rev
UHA_father_df %>%
ggplot(aes(x = forcats::fct_rev(Species), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
sort(UHA_father_df$Count)
?sort()
sort(UHA_father_df$Count, decreasing = TRUE)
UHA_father_df[sort(UHA_father_df$Count, decreasing = TRUE)]
UHA_father_df[sort(UHA_father_df$Count, decreasing = TRUE),]
UHA_father_df$Count[sort(UHA_father_df$Count, decreasing = TRUE),]
UHA_father_df$Count[sort(UHA_father_df$Count, decreasing = TRUE)]
#create summary father data frame
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
UHA_father_df$Count[sort(UHA_father_df$Count, decreasing = TRUE)]
?factor
UHA_father_df <- factor(UHA_father_df$Species,
levels = UHA_father_df$Species[sort(UHA_father_df$Count, decreasing = TRUE)])
UHA_father_df
#create summary father data frame
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
#rename
colnames(UHA_father_df) <- c("Species", "Count")
UHA_father_df$Species <- factor(UHA_father_df$Species,
levels = UHA_father_df$Species[sort(UHA_father_df$Count, decreasing = TRUE)])
View(UHA_father_df)
#create summary father data frame
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
#rename
colnames(UHA_father_df) <- c("Species", "Count")
sort(UHA_father_df$Count, decreasing = TRUE)
UHA_father_df$Species[sort(UHA_father_df$Count, decreasing = TRUE)]
UHA_father_df$Species
UHA_father_df$Species[UHA_father_df$Count == 128]
class(UHA_father_df$Count)
class(UHA_father_df$Count) <- "numeric"
UHA_father_df$Species <- factor(UHA_father_df$Species,
levels = UHA_father_df$Species[sort(UHA_father_df$Count, decreasing = TRUE)])
#create summary father data frame
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
class(UHA_father_df$Count) <- "numeric"
UHA_father_df$Species <- factor(UHA_father_df$Species,
levels = UHA_father_df$Species[c(128,3,1)])
#create summary father data frame
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
#rename
colnames(UHA_father_df) <- c("Species", "Count")
class(UHA_father_df$Count) <- "numeric"
UHA_father_df$Species <- factor(UHA_father_df$Species,
levels = UHA_father_df$Species[c(128,3,1)])
View(UHA_father_df)
#create summary father data frame
UHA_father_df <- as.data.frame(table(UHA_res_df$Candidate_Father_Species))
class(UHA_father_df)
?arrange
UHA_father_df2 <- UHA_father_df %>%
arrange()
View(UHA_father_df2)
UHA_father_df2 <- UHA_father_df %>%
arrange(desc(Count))
UHA_father_df2 <- UHA_father_df %>%
dplyr::arrange(desc(Count))
UHA_father_df2 <- UHA_father_df %>%
dplyr::arrange(desc("Count"))
View(UHA_father_df2)
#rename
colnames(UHA_father_df) <- c("Species", "Count")
UHA_father_df2 <- UHA_father_df %>%
dplyr::arrange(desc(Count))
UHA_father_df %>%
ggplot(aes(x = forcats::fct_rev(Species), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
UHA_father_df2 %>%
ggplot(aes(x = forcats::fct_rev(Species), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
###### Hybrid status x mating distance -------------------
png(paste0("Results/Parentage_Results/Figures/AL_HCF_hybrid_species_count.png"),
res = 600, width = 5200, height = 3500)
UHA_father_df2 %>%
ggplot(aes(x = forcats::fct_rev(Species), y=Count))+
geom_bar(stat = "identity", fill = "darkgreen") +
geom_text(aes(label = paste("n =", Count)), vjust = -0.5) +
labs(title="Count of Offspring Produced by Each Candidate Father Tree Species",
x="Candidate Father Species") +
theme_bw() +
scale_y_continuous(limits = c(0,150)) +
theme(axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
plot.title = element_text(size = 18, hjust = 1))
dev.off()
library(tidyverse)
library(dplyr)
library(ggplot2)
