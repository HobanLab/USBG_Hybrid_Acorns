install.packages("Demerelate")
#set working directory
setwd("../../..")
#load parentage result dfs
par_scen_df_list <- list.files(path = "Results/Parentage_Results/CSV_Files",pattern = "analysis_df.csv")
#reorder
par_scen_df_list <- list(par_scen_df_list[[1]], par_scen_df_list[[2]],
par_scen_df_list[[4]], par_scen_df_list[[3]])
#load full scenario data frames
full_scen <- c("all_loci_AF", #all loci included with all father assignments
"all_loci_HCF", #all loci with only high confidence fathers included
"red_loci_AF", #reduced loci with all father assignments
"red_loci_HCF" #reduce loci with only high confidence father assignments included
)
#list of maternal IDs
mat_ids <- c("MT1", "MT2", "MT3", "MT4", "MT5",
"MT6", "MT7", "MT8", "MT9", "MT10", "MT11")
mat_UHA_ids <- c("UHA-0009","UHA-0010", "UHA-0012", "UHA-0013", "UHA-0014",
"UHA-0015", "UHA-0016", "UHA-0257", "UHA-0260", "UHA-0261",
"UHA-0351")
#read in these files as CSVs
par_scen_df <- list()
for(df in seq_along(par_scen_df_list)){
par_scen_df[[df]] <- read.csv(paste0("Results/Parentage_Results/CSV_Files/", par_scen_df_list[[df]]))
#add MT ID column
par_scen_df[[df]]$MT_ID <- NA
for(mat in seq_along(mat_ids)){
#add MT IDs
par_scen_df[[df]][par_scen_df[[df]]$Mother_ID == mat_UHA_ids[[mat]],"MT_ID"] <- mat_ids[[mat]]
}
}
par_scen_df[[1]]
#loop over all of the par sum df
par_sum_df_list <- list()
#loop over all of the par sum df
par_sum_df <- list.files(path = "Results/Parentage_Results/CSV_Files",
pattern = "par_sum.csv")
par_sum_df
#reorg
par_sum_df <- list(par_sum_df[[2]], par_sum_df[[1]],
par_sum_df[[4]], par_sum_df[[3]])
#loop to calculate
exc_prob_df <- matrix(nrow = length(par_sum_df),
ncol = 2)
par <- 1
#load in par sum_df
par_sum_df_temp <- read.csv(paste0("Results/Parentage_Results/CSV_Files",
par_sum_df[[par]]))
#load in par sum_df
par_sum_df_temp <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
colnames(par_sum_df_temp)
colnames(par_sum_df_temp) <- gsub("\\.","_", colnames(par_sum_df_temp))
colnames(par_sum_df_temp)
par_sum_df_temp[["First_parent_non_exclusion_probability"]]
mean(par_sum_df_temp[["First_parent_non_exclusion_probability"]])
par_sum_df_temp[["Second_parent_non_exclusion_probability"]]
mean(par_sum_df_temp[["Second_parent_non_exclusion_probability"]])
for(par in seq_along(par_sum_df)){
#load in par sum_df
par_sum_df_temp <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
#rename colnames
colnames(par_sum_df_temp) <- gsub("\\.","_", colnames(par_sum_df_temp))
#now sum the columns
exc_prob_df[par,1] <- mean(par_sum_df_temp[["First_parent_non_exclusion_probability"]])
exc_prob_df[par,2] <- mean(par_sum_df_temp[["Second_parent_non_exclusion_probability"]])
}
for(par in seq_along(par_sum_df)){
#load in par sum_df
par_sum_df_temp <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
#rename colnames
#colnames(par_sum_df_temp) <- gsub("\\.","_", colnames(par_sum_df_temp))
#now sum the columns
#exc_prob_df[par,1] <- mean(par_sum_df_temp[["First_parent_non_exclusion_probability"]])
#exc_prob_df[par,2] <- mean(par_sum_df_temp[["Second_parent_non_exclusion_probability"]])
}
seq_along(par_sum_df)
par_sum_df[[1]]
paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]])
par <- 1
#load in par sum_df
par_sum_df_temp <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
#reorg list
par_sum_df <- list(par_sum_df[[2]], par_sum_df[[1]],
par_sum_df[[4]], par_sum_df[[3]])
par_sum_df[[1]]
#reorg list
par_sum_df <- list(par_sum_df[[2]], par_sum_df[[1]],
par_sum_df[[4]], par_sum_df[[3]])
par_sum_df
par <- 1
#load in par sum_df
par_sum_df_temp <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
par_sum_df[[1]]
read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
#load in par sum_df
temp_df <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
#rename colnames
colnames(temp_df) <- gsub("\\.","_", colnames(temp_df))
#now sum the columns
exc_prob_df[par,1] <- mean(par_sum_df_temp[["First_parent_non_exclusion_probability"]])
#now sum the columns
exc_prob_df[par,1] <- mean(temp_df[["First_parent_non_exclusion_probability"]])
exc_prob_df[par,2] <- mean(temp_df[["Second_parent_non_exclusion_probability"]])
exc_prob_df
for(par in seq_along(par_sum_df)){
#load in par sum_df
temp_df <- read.csv(paste0("Results/Parentage_Results/CSV_Files/",
par_sum_df[[par]]))
#rename colnames
colnames(temp_df) <- gsub("\\.","_", colnames(temp_df))
#now sum the columns
exc_prob_df[par,1] <- mean(temp_df[["First_parent_non_exclusion_probability"]])
exc_prob_df[par,2] <- mean(temp_df[["Second_parent_non_exclusion_probability"]])
}
exc_prob_df
#name columns and rows
rownames(exc_prob_df) <- c("all_loci", "all_loci_HCF", "red_loci", "red_loci_HCF")
#name columns and rows
rownames(exc_prob_df) <- c("all_loci", "all_loci_HCF", "red_loci", "red_loci_HCF")
colnames(exc_prob_df) <- c("First_parent_non_exclusion_probability",
"Second_parent_non_exclusion_probability")
#write out table
write.csv(exc_prob_df, "./Results/Parentage_Results/CSV_Files/non_exclusion_probabilities.csv")
